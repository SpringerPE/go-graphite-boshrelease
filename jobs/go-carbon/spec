---
name: go-carbon

packages:
- go-carbon

templates:
  bin/go-carbon_ctl: bin/go-carbon_ctl
  config/go-carbon.conf.erb: config/go-carbon.conf
  config/storage-schema.conf.erb: config/storage-schemas.conf
  config/storage-aggregation.conf.erb: config/storage-aggregation.conf
  bin/monit_debugger: bin/monit_debugger
  data/properties.sh.erb: data/properties.sh

provides:
- name: go-carbon-backend
  type: tcp
  properties:
    - go-carbon.tcp_listen
- name: go-carbon-udp
  type: udp
  properties:
    - go-carbon.udp.enabled
    - go-carbon.udp.port
- name: go-carbon-carbonserver
  type: carbonserver
  properties:
    - go-carbon.carbonserver.port

properties:
  go-carbon.metric_interval:
    description: 
    default: "1m0s"
  go-carbon.max_cpu:
    description: Number of CPUs to use (GOMAXPROCS)
    default: 0
  go-carbon.whisper_workers:
    description:
    default: 16
  go-carbon.cache_max_size:
    description:
    default: 20000000
  go-carbon.write_strategy:
    description: "Strategy to persist metrics. Values: max, sorted, noop"
    default: "max"
  go-carbon.tcp_listen:
    description:
    default: 2003

  go-carbon.udp.enabled:
    description: enable udp if true
    default: false
  go-carbon.udp.port:
    description: udp port
    default: 2003
  go-carbon.udp.host:
    description: udp host
    default: ""

  go-carbon.pickle.enabled:
    description: enable pickle if true
    default: false
  go-carbon.pickle.port:
    description: pickle port
    default: 2004
  go-carbon.pickle.host:
    description: pickle host
    default: ""

  go-carbon.carbonlink.enabled:
    description: enable carbonlink if true
    default: false
  go-carbon.carbonlink.port:
    description: carbonlink port
    default: 2007
  go-carbon.carbonlink.host:
    description: carbonlink host
    default: ""

  go-carbon.schemas:
    description: Storage schemas
    default:
      - name: "carbon"
        pattern: "^carbon\\."
        retentions: "60:90d"
      - name: "default_1min_for_1day"
        pattern: ".*"
        retentions: "60s:1d"

  go-carbon.aggregations:
    description: storage aggregations
    default: []

  go-carbon.carbonserver.enabled:
      description:
      default: false
  go-carbon.carbonserver.port:
    description: carbonserver port
    default: 8080
  go-carbon.carbonserver.host:
    description: carbonserver host
    default: "localhost"
  go-carbon.carbonserver.read_timeout:
    description:
    default: "60s"
  go-carbon.carbonserver.write_timeout:
    description:
    default: "60s"


  go-carbon.dump.enabled:
      description: enable dump
      default: false
