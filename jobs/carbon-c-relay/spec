---
name: carbon-c-relay

packages:
- carbon-c-relay

templates:
  bin/carbon-c-relay_ctl: bin/carbon-c-relay_ctl
  bin/monit_debugger: bin/monit_debugger
  data/properties.sh.erb: data/properties.sh
  config/carbon-c-relay.conf: config/carbon-c-relay.conf

provides:
- name: carbon-c-relay
  type: relay
  properties:
  - carbon_c_relay.port

consumes:
- name: go-carbon-tcp
  type: tcp
- name: go-carbon-udp
  type: udp
- name: relay
  type: relay
  optional: true


properties:
  carbon-c-relay.lb:
    description: "Load balancing for the backends: <forward | any_of [useall] | failover | <carbon_ch | fnv1a_ch | jump_fnv1a_ch>"
    default: "fnv1a_ch"
  carbon-c-relay.replication:
    description: Replication factor over the backends
    default: 2
  carbon-c-relay.ext_clusters:
    description: List of hash with the definition of external clusters
    default: []
  carbon-c-relay.ext_rules:
    description: List of hash with the definition of rules to send to external clusters
    default: []
  carbon-c-relay.rewrite:
    description: List of hash with the definition of rules to rewrite metrics
    default: []
  carbon_c_relay.port:
    description: listen on port for connections
    default: 2003
  carbon_c_relay.workers:
    description: number of worker threads
    default: 4
  carbon_c_relay.batch_size:
    description: server send batch size
    default: 2500
  carbon_c_relay.queue_size:
    description: server queue size
    default: 25000
  carbon_c_relay.stats_interval:
    description: statistics sending interval in seconds
    default: 60
  carbon_c_relay.stats_prefix:
    description: adds prefix into the namespace when sending stats. Example using "LIVE" you will get "carbon.relays.LIVE_carbon_c_relay_leader_z1_0"
    default: ""
  carbon_c_relay.allowed_chars:
    description: characters to allow next to [A-Za-z0-9]
    default: "-_:#"
