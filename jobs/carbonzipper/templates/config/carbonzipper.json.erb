# NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE
#
# A single shell-style (#) comment block may appear at the top of the file
# and will be stripped off. However, the remainder of the file must be valid JSON.
# (So the `//` comments below will cause it to fail)
# (grep -v '^#\|\/\/\s' example.conf | jq '.') will extract the JSON.
#
# NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE NOTE
{
    "Port": <%= p('carbonzipper.port','9090') %>,
    "MaxProcs": <%= p('carbonzipper.maxprocs','0') %>,
    <% if_p("carbonzipper.graphite") do |graphite| %>
    "GraphiteHost": "<%= graphite['host'] %>",
    <% if graphite['interval'] %>
    "IntervalSec": <%= graphite['interval'] %>,
    <% end %>
    <% end %>
    "Buckets": 10,
    "TimeoutMs": <%= p('carbonzipper.timeout_ms_total_request','10000') %>,
    "TimeoutMsAfterAllStarted": <%= p('carbonzipper.timeout_ms_backend','2000') %>,
    "ConcurrencyLimitPerServer": <%= p('carbonzipper.concurrency_per_server','0') %>,
    "MaxIdleConnsPerHost": <%= p('carbonzipper.max_idle_con_per_server','100') %>,
    "Backends": [
    <% if_p("carbonzipper.backends") do %>
    <% p("carbonzipper.backends").each_with_index do |backend, i| %>
    "<%= backend["host"] %>"<%= ',' if i < (p("carbonzipper.backends").size - 1) %>
    <% end %>
    <% end %>
    ]
}

